---
title: Dithering
---



<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const img = new Image();

img.src = '/images/jmstorm_1980s_hallway_illustration_with_five_doors_and_a_man_in_db445077-c33b-41a6-9f29-c82e90ff519a.avif'; // Replace with the path to your image.
img.crossOrigin = 'anonymous';
img.onload = () => {
    canvas.width = img.width;
    canvas.height = img.height;
    ctx.drawImage(img, 0, 0);
    applyFloydSteinbergDithering(ctx, canvas.width, canvas.height);
};

function applyFloydSteinbergDithering(ctx, width, height) {
    const imageData = ctx.getImageData(0, 0, width, height);
    const data = imageData.data;

    for (let y = 0; y < height; y++) {
    for (let x = 0; x < width; x++) {
        const index = (y * width + x) * 4;
        const oldPixel = [data[index], data[index + 1], data[index + 2]];
        const newPixel = oldPixel.map(channel => channel < 128 ? 0 : 255);
        const quantError = oldPixel.map((channel, i) => channel - newPixel[i]);

        data[index] = newPixel[0];
        data[index + 1] = newPixel[1];
        data[index + 2] = newPixel[2];

        distributeError(x + 1, y, quantError, 7 / 16);
        distributeError(x - 1, y + 1, quantError, 3 / 16);
        distributeError(x, y + 1, quantError, 5 / 16);
        distributeError(x + 1, y + 1, quantError, 1 / 16);
    }
    }

    ctx.putImageData(imageData, 0, 0);

    function distributeError(x, y, quantError, factor) {
    if (x < 0 || x >= width || y < 0 || y >= height) return;
    const index = (y * width + x) * 4;
    data[index] = Math.max(0, Math.min(255, data[index] + quantError[0] * factor));
    data[index + 1] = Math.max(0, Math.min(255, data[index + 1] + quantError[1] * factor));
    data[index + 2] = Math.max(0, Math.min(255, data[index + 2] + quantError[2] * factor));
    }
}
</script>